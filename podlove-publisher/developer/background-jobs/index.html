<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.a9343a191">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Podlove Documentation Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Podlove Documentation Blog Atom Feed"><title data-react-helmet="true">Background Jobs | Podlove Documentation</title><meta data-react-helmet="true" property="og:url" content="https://docs.podlove.org/podlove-publisher/developer/background-jobs"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-publisher-current"><meta data-react-helmet="true" property="og:title" content="Background Jobs | Podlove Documentation"><meta data-react-helmet="true" name="description" content="The Podlove Background Job system enables expensive, long-running tasks to run safely. It achieves this by breaking big tasks up into smaller subtasks. The state of a job is persisted, enabling it to be halted and resumed in a different process. The job system is based on WordPress Cron."><meta data-react-helmet="true" property="og:description" content="The Podlove Background Job system enables expensive, long-running tasks to run safely. It achieves this by breaking big tasks up into smaller subtasks. The state of a job is persisted, enabling it to be halted and resumed in a different process. The job system is based on WordPress Cron."><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://docs.podlove.org/podlove-publisher/developer/background-jobs"><link data-react-helmet="true" rel="alternate" href="https://docs.podlove.org/podlove-publisher/developer/background-jobs" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://docs.podlove.org/podlove-publisher/developer/background-jobs" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.fde5078d.css">
<link rel="preload" href="/assets/js/runtime~main.41d352f5.js" as="script">
<link rel="preload" href="/assets/js/main.b5248fb2.js" as="script">
</head>
<body data-theme="light">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#main" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle" type="button" tabindex="0"><svg aria-label="Menu" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><img src="/img/logo.svg" alt="Podlove Logo" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/img/logo.svg" alt="Podlove Logo" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><strong class="navbar__title">Documentation</strong></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/podlove-publisher/index.html">Podlove Publisher</a><a class="navbar__item navbar__link" href="/podlove-web-player/index.html">Podlove Web Player</a><a href="https://subscribe-button.podlove.org" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Podlove Subscribe Button</a></div><div class="navbar__items navbar__items--right"><a href="https://opencollective.com/podlove" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Donation</a><div class="dsla-search-wrapper"><div class="dsla-search-field"></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/"><img src="/img/logo.svg" alt="Podlove Logo" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/img/logo.svg" alt="Podlove Logo" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><strong class="navbar__title">Documentation</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a aria-current="page" class="menu__link navbar__link--active" href="/podlove-publisher/index.html">Podlove Publisher</a></li><li class="menu__list-item"><a class="menu__link" href="/podlove-web-player/index.html">Podlove Web Player</a></li><li class="menu__list-item"><a href="https://subscribe-button.podlove.org" target="_blank" rel="noopener noreferrer" class="menu__link">Podlove Subscribe Button</a></li><li class="menu__list-item"><a href="https://opencollective.com/podlove" target="_blank" rel="noopener noreferrer" class="menu__link">Donation</a></li></ul></div></div></div></nav><div class="main-wrapper docs-wrapper doc-page"><div class="docPage_31aa"><div class="docSidebarContainer_3Kbt" role="complementary"><div class="sidebar_15mo"><div class="menu menu--responsive thin-scrollbar menu_Bmed"><button aria-label="Open menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_fgN0" width="24" height="24" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/podlove-publisher/">Introduction</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Guides</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/podlove-publisher/guides/getting-started">Getting Started</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/podlove-publisher/guides/podcast-migration">Podcast Migration</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/podlove-publisher/guides/podcast-network">Podcast Network</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/podlove-publisher/guides/templates">Templates</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Modules</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/podlove-publisher/modules/slacknotes">Slacknotes</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/podlove-publisher/modules/transcripts">Transcripts</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Reference</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/podlove-publisher/reference/shortcodes">Shortcodes</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Templates</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/podlove-publisher/reference/templates/templates">Templates</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Template Tags</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/podlove-publisher/reference/templates/template-tags/podcast">Podcast</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/podlove-publisher/reference/templates/template-tags/episode">Episode</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/podlove-publisher/reference/templates/template-tags/network">Network</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/podlove-publisher/reference/templates/template-tags/podcast-list">Podcast List</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/podlove-publisher/reference/templates/template-tags/chapter">Chapter</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/podlove-publisher/reference/templates/template-tags/feed">Feed</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/podlove-publisher/reference/templates/template-tags/asset">Asset</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/podlove-publisher/reference/templates/template-tags/file">File</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/podlove-publisher/reference/templates/template-tags/image">Image</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/podlove-publisher/reference/templates/template-tags/tag">Tag</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/podlove-publisher/reference/templates/template-tags/category">Category</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/podlove-publisher/reference/templates/template-tags/duration">Duration</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/podlove-publisher/reference/templates/template-tags/contributor">Contributor</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/podlove-publisher/reference/templates/template-tags/season">Season</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/podlove-publisher/reference/templates/template-tags/service">Service</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/podlove-publisher/reference/templates/template-tags/show">Show</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/podlove-publisher/reference/templates/template-tags/license">License</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/podlove-publisher/reference/templates/template-tags/flattr">Flattr</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/podlove-publisher/reference/templates/template-tags/date-time">DateTime</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/podlove-publisher/reference/templates/template-tags/line">Line</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/podlove-publisher/reference/templates/template-tags/group">Group</a></li></ul></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/podlove-publisher/reference/templates/template-conditionals">Template Conditionals</a></li></ul></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/podlove-publisher/reference/php-constants">Constants</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/podlove-publisher/reference/dsgvo-gdpr">DSGVO / GDPR</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/podlove-publisher/reference/download-analytics">Download Analytics</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">Developer</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/podlove-publisher/developer/projects">Projects</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/podlove-publisher/developer/modules">Modules</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/podlove-publisher/developer/background-jobs">Background Jobs</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Faq</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/podlove-publisher/faq/image-cache">Image Cache</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/podlove-publisher/faq/chapter-marks">Chapter Marks</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/podlove-publisher/faq/episode-images">Episode Images</a></li></ul></li><li class="menu__list-item"><a class="menu__link" href="/podlove-publisher/requirements">Requirements</a></li><li class="menu__list-item"><a class="menu__link" href="/podlove-publisher/join-the-beta">Join the Beta</a></li></ul></div></div></div><main class="docMainContainer_3ufF"><div class="container padding-vert--lg docItemWrapper_3FMP"><div class="row"><div class="col docItemCol_3FnS"><div class="docItemContainer_33ec"><article><header><h1 class="docTitle_3a4h">Background Jobs</h1></header><div class="markdown"><p>The Podlove Background Job system enables expensive, long-running tasks to run safely. It achieves this by breaking big tasks up into smaller subtasks. The state of a job is persisted, enabling it to be halted and resumed in a different process. The job system is based on WordPress Cron.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="ideal-setup"></a>Ideal Setup<a class="hash-link" href="#ideal-setup" title="Direct link to heading">#</a></h2><p>There are different ways to run WordPress Cron. By default, WordPress executes cron whenever necessary at the end of web requests. This works (mostly) but is not ideal since it requires user interaction to run jobs. It is preferred to use system crons. Refer to <a href="https://askubuntu.com/questions/2368/how-do-i-set-up-a-cron-job#2369" target="_blank" rel="noopener noreferrer">How do I set up a Cron job?</a> or ask your system administrator if you are not sure how.</p><p>First, you need to tell WordPress to stop spawning its own cron processes.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly php"><div tabindex="0" class="prism-code language-php codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;?php</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"># wp-config.php</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">define( &#x27;DISABLE_WP_CRON&#x27;, true );</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>The system crontab should look like this:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><div tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">* * * * *   php /path/to/wordpress/wp-cron.php &gt;&gt;/var/log/cron.log 2&gt;&amp;1</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>Or maybe you need to run it as a certain user:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><div tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">* * * * *   sudo -u www-data php /path/to/wordpress/wp-cron.php &gt;&gt;/var/log/cron.log 2&gt;&amp;1</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>If you are using a WordPress Multisite Network, you need one line per site in your crontab:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><div tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">* * * * *   sudo HTTP_HOST=example.com -u www-data php /path/to/wordpress/wp-cron.php &gt;&gt;/var/log/cron.log 2&gt;&amp;1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">* * * * *   sudo HTTP_HOST=foo.example.com -u www-data php /path/to/wordpress/wp-cron.php &gt;&gt;/var/log/cron.log 2&gt;&amp;1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">* * * * *   sudo HTTP_HOST=bar.example.com -u www-data php /path/to/wordpress/wp-cron.php &gt;&gt;/var/log/cron.log 2&gt;&amp;1</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>This entry runs the cron every minute.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="configuration"></a>Configuration<a class="hash-link" href="#configuration" title="Direct link to heading">#</a></h2><ul><li><code>max_seconds_per_request</code> is the time in seconds after which no more job subtask is started. Can be overridden with WordPress filter <code>podlove_job_max_seconds_per_request</code> or shell variable <code>PODLOVE_JOB_MAX_SECONDS_PER_REQUEST</code>. Default: 20.</li><li><code>lock_duration_buffer</code> is the additional time in seconds no job can be run. When a job runner starts, no other process can spawn jobs in parallel for <code>max_seconds_per_request + lock_duration_buffer</code> seconds. This is important because some jobs may in fact run longer than <code>max_seconds_per_request</code>. Default: 5.</li></ul><p>The sum <code>max_seconds_per_request + lock_duration_buffer</code> should not exceed PHP ini value <code>max_execution_time</code> which defaults to 30 on most systems. Be aware that different PHP settings may be active depending on how you run the crons (WordPress default or system cron approach described above). If you are running a cron every minute, the sum should be smaller than 60 seconds.</p><p>Using the system cron approach, you can set config values using shell variables:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><div tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">* * * * *   PODLOVE_JOB_MAX_SECONDS_PER_REQUEST=45 php /path/to/wordpress/wp-cron.php &gt;&gt;/var/log/cron.log 2&gt;&amp;1</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="resources"></a>Resources<a class="hash-link" href="#resources" title="Direct link to heading">#</a></h2><ul><li><a href="https://developer.wordpress.org/plugins/cron/" target="_blank" rel="noopener noreferrer">WordPress Plugin Handbook: Cron</a></li><li><a href="https://wordpress.org/plugins/wp-crontrol/" target="_blank" rel="noopener noreferrer">WP Crontrol</a>: Useful plugin to debug WP cron jobs.</li></ul></div></article><div class="margin-vert--xl"><div class="row"><div class="col"><a href="https://github.com/podlove/podlove.github.com/edit/master/publisher/publisher/developer/background-jobs.mdx" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="1.2em" width="1.2em" preserveAspectRatio="xMidYMid meet" role="img" viewBox="0 0 40 40" class="iconEdit_2_ui" aria-label="Edit page"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/podlove-publisher/developer/modules"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">« Modules</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/podlove-publisher/faq/image-cache"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Image Cache »</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#ideal-setup" class="table-of-contents__link">Ideal Setup</a></li><li><a href="#configuration" class="table-of-contents__link">Configuration</a></li><li><a href="#resources" class="table-of-contents__link">Resources</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items"><li class="footer__item"><a href="https://community.podlove.org/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Podlove Community</a></li><li class="footer__item"><a href="https://twitter.com/podlove_org" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter</a></li><li class="footer__item"><a href="https://discord.gg/tHnGgvg" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord</a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items"><li class="footer__item"><a href="https://github.com/podlove" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub</a></li><li class="footer__item"><a href="https://podlovers.org" target="_blank" rel="noopener noreferrer" class="footer__link-item">Podlovers Podcast</a></li></ul></div></div><div class="footer__bottom text--center"></div></div></footer></div>
<script src="/assets/js/runtime~main.41d352f5.js"></script>
<script src="/assets/js/main.b5248fb2.js"></script>
</body>
</html>